<?xml version="1.0" encoding="UTF-8"?>
<!--
  ROOM PAGE - DETAILED SPECIFICATION
  –î–µ—Ç–∞–ª—å–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è —ç–∫—Ä–∞–Ω–∞ –∫–æ–º–Ω–∞—Ç—ã –¢–∞—Ç—å—è–Ω—ã
  
  –†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π —Ñ–∞–π–ª: ../SCREENS_SPECIFICATION.xml
  –°–≤—è–∑–∞–Ω–Ω—ã–µ –ø—Ä–æ–º—Ç—ã:
    - ../../animation/characters/tatyana.xml
    - ../../animation/characters/sam.xml
    - ../../animation/objects/bedroom.xml
-->

<screen name="RoomPage" type="location" location="room">

  <meta>
    <route>/room</route>
    <default>true</default>
    <description>–û—Å–Ω–æ–≤–Ω–æ–π –∏–≥—Ä–æ–≤–æ–π —ç–∫—Ä–∞–Ω - –∫–æ–º–Ω–∞—Ç–∞ –¢–∞—Ç—å—è–Ω—ã —Å –∏–∑–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–º –≤–∏–¥–æ–º</description>
    <accessibility>–í—Å–µ –æ–±—ä–µ–∫—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —á–µ—Ä–µ–∑ —Ç–∞–ø</accessibility>
  </meta>

  <!-- –°–¢–†–£–ö–¢–£–†–ê –°–õ–û–Å–í -->
  <layout-layers>
    <layer name="background" z-index="0">
      <type>Static gradient background</type>
      <color>linear-gradient(180deg, #E0C3FC 0%, #8EC5FC 100%)</color>
      <time-of-day-variant enabled="true">
        <morning>linear-gradient(180deg, #FFECD2 0%, #FCB69F 100%)</morning>
        <day>linear-gradient(180deg, #E0C3FC 0%, #8EC5FC 100%)</day>
        <evening>linear-gradient(180deg, #FFA17F 0%, #00223E 100%)</evening>
        <night>linear-gradient(180deg, #2C3E50 0%, #000000 100%)</night>
      </time-of-day-variant>
    </layer>

    <layer name="room-back-wall" z-index="1">
      <type>Isometric room back wall</type>
      <content>–°—Ç–µ–Ω–∞, –æ–∫–Ω–æ, –∫–∞—Ä—Ç–∏–Ω—ã</content>
      <lighting dynamic="true" affects="shadows, highlights" />
    </layer>

    <layer name="room-floor" z-index="2">
      <type>Isometric floor with furniture</type>
      <perspective>2:1 isometric (45¬∞)</perspective>
      <content>–ü–æ–ª, –∫–æ–≤—ë—Ä, —Ç–µ–Ω–∏ –æ—Ç –º–µ–±–µ–ª–∏</content>
    </layer>

    <layer name="interactive-objects" z-index="3">
      <type>Clickable objects with animations</type>
      <render-order>Back to front by Y position</render-order>
    </layer>

    <layer name="character" z-index="4">
      <type>Tatyana sprite with animations</type>
      <position>Center of room</position>
      <shadow enabled="true" opacity="0.3" />
    </layer>

    <layer name="npcs" z-index="5">
      <type>Sam, Garfield with AI behavior</type>
      <wander enabled="true" bounds="room" />
    </layer>

    <layer name="hud" z-index="10">
      <type>UI overlay - stats, time, money</type>
      <sticky>true</sticky>
      <safe-area>true</safe-area>
    </layer>

    <layer name="action-menu" z-index="100">
      <type>Popup menu for object interactions</type>
      <visibility>Dynamic on tap</visibility>
    </layer>

    <layer name="modals" z-index="600">
      <type>Modal dialogs and confirmations</type>
    </layer>
  </layout-layers>

  <!-- HUD (–í–ï–†–•–ù–Ø–Ø –ü–ê–ù–ï–õ–¨) -->
  <hud position="top" height="80px" sticky="true">
    <background>
      <blur>8px</blur>
      <opacity>0.95</opacity>
      <color>rgba(255, 255, 255, 0.9)</color>
      <border-bottom>1px solid rgba(0,0,0,0.1)</border-bottom>
    </background>

    <safe-area respect="true">
      <padding-top>env(safe-area-inset-top)</padding-top>
    </safe-area>

    <layout display="flex" justify="space-between" align="center" padding="0 16px">
      <!-- –õ–µ–≤–∞—è —á–∞—Å—Ç—å: –°—Ç–∞—Ç—ã -->
      <stats-group position="left" gap="12px">
        <stat name="energy" icon="battery" color="#FCD34D" max="100">
          <display type="icon + number" />
          <animation on-change="pulse" duration="300ms" />
          <tooltip>–≠–Ω–µ—Ä–≥–∏—è: –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ –¥–ª—è –¥–µ–π—Å—Ç–≤–∏–π</tooltip>
        </stat>

        <stat name="happiness" icon="smile" color="#F093FB" max="100">
          <display type="icon + number" />
          <emoji>üòä</emoji>
          <tooltip>–°—á–∞—Å—Ç—å–µ: –≤–ª–∏—è–µ—Ç –Ω–∞ –æ—Ç–Ω–æ—à–µ–Ω–∏—è</tooltip>
        </stat>

        <stat name="health" icon="heart" color="#EF4444" max="100">
          <display type="icon + number" />
          <warning-threshold>30</warning-threshold>
          <tooltip>–ó–¥–æ—Ä–æ–≤—å–µ</tooltip>
        </stat>
      </stats-group>

      <!-- –¶–µ–Ω—Ç—Ä: –í—Ä–µ–º—è –∏ –¥–∞—Ç–∞ -->
      <time-widget position="center">
        <time format="HH:mm" size="1.25rem" weight="600" />
        <date format="dd MMM, EEE" size="0.875rem" color="#6B7280" />
        <icon name="clock" size="20px" />
      </time-widget>

      <!-- –ü—Ä–∞–≤–æ: –î–µ–Ω—å–≥–∏ -->
      <money position="right">
        <icon emoji="üí∞" size="24px" />
        <amount format="number" size="1.125rem" weight="700" />
        <animation on-change="coin-flip" duration="500ms" />
      </money>
    </layout>
  </hud>

  <!-- –ò–ó–û–ú–ï–¢–†–ò–ß–ï–°–ö–ê–Ø –ö–û–ú–ù–ê–¢–ê -->
  <isometric-room perspective="2:1" angle="45deg" viewport="1920x1080">
    <!-- –ü–ï–†–°–û–ù–ê–ñ –¢–ê–¢–¨–Ø–ù–ê -->
    <character name="tatyana" ref="../../animation/characters/tatyana.xml">
      <position x="center" y="center" z-index="4" />
      <sprite size="64x64" />
      <animations>
        <idle default="true" fps="6" loop="true" />
        <walk fps="10" loop="true" directions="4" />
        <work fps="6" loop="true" />
        <sleep fps="4" loop="true" />
        <interaction fps="8" loop="false" />
      </animations>
      <shadow enabled="true" opacity="0.3" offset="0, 8px" blur="4px" />
      <movement speed="2" type="click-to-move" pathfinding="true" />
    </character>

    <!-- –ò–ù–¢–ï–†–ê–ö–¢–ò–í–ù–´–ï –û–ë–™–ï–ö–¢–´ -->
    <interactive-objects>
      <!-- –ö–†–û–í–ê–¢–¨ -->
      <object id="bed" type="furniture" category="rest">
        <position x="200" y="150" z-index="3" />
        <sprite size="128x128" atlas="../../animation/objects/bedroom.xml" />
        <states>
          <state name="neat" default="true" />
          <state name="messy" transition-from="occupied" />
          <state name="occupied" active-when="tatyana-sleeping" />
        </states>
        <highlight type="glow" color="var(--color-primary)" opacity="0.5" pulse="1.5s" />
        <actions>
          <action id="sleep" label="üò¥ –°–ø–∞—Ç—å" icon="moon">
            <requirements>
              <time between="20:00-09:00" message="–ú–æ–∂–Ω–æ —Å–ø–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω–æ—á—å—é" />
              <energy min="0" />
            </requirements>
            <effects>
              <energy restore="100" />
              <time advance="8h" />
              <happiness change="+10" />
            </effects>
            <animation character="sleep" object="occupied" duration="8h" />
            <haptic intensity="light" />
          </action>

          <action id="make-bed" label="üõèÔ∏è –ó–∞—Å—Ç–µ–ª–∏—Ç—å –∫—Ä–æ–≤–∞—Ç—å" icon="check">
            <requirements>
              <state current="messy" />
            </requirements>
            <effects>
              <energy cost="5" />
              <happiness change="+5" />
              <state change-to="neat" />
            </effects>
            <animation duration="2s" />
          </action>
        </actions>
      </object>

      <!-- –ö–û–ú–ü–¨–Æ–¢–ï–† -->
      <object id="computer" type="work-station" category="work">
        <position x="800" y="200" z-index="3" />
        <sprite size="128x128" />
        <states>
          <state name="off" />
          <state name="idle" screen-glow="true" color="#93C5FD" />
          <state name="working" active-when="tatyana-working" />
        </states>
        <ambient-animation type="screen-flicker" fps="3" />
        <actions>
          <action id="work" label="üíª –†–∞–±–æ—Ç–∞—Ç—å" icon="briefcase">
            <requirements>
              <energy min="20" />
              <time between="09:00-22:00" />
            </requirements>
            <effects>
              <energy cost="20" />
              <time advance="2h" />
              <money reward="100" />
              <skill name="work" xp="+10" />
            </effects>
            <animation character="work" object="working" duration="2h" />
          </action>

          <action id="browse" label="üåê –ò–Ω—Ç–µ—Ä–Ω–µ—Ç" icon="globe">
            <requirements>
              <energy min="5" />
            </requirements>
            <effects>
              <energy cost="5" />
              <time advance="30m" />
              <happiness change="+5" />
            </effects>
          </action>
        </actions>
      </object>

      <!-- –¢–ï–õ–ï–§–û–ù -->
      <object id="phone" type="communication" category="social">
        <position x="700" y="180" z-index="3" />
        <sprite size="64x64" />
        <states>
          <state name="idle" />
          <state name="notification" animation="blink" />
          <state name="active" />
        </states>
        <notification-badge visible="dynamic" />
        <actions>
          <action id="call-husband" label="üìû –ü–æ–∑–≤–æ–Ω–∏—Ç—å –º—É–∂—É" icon="phone">
            <effects>
              <energy cost="5" />
              <time advance="30m" />
              <relationship target="husband" change="+5" />
              <happiness change="+10" />
            </effects>
            <dialog type="phone-conversation" character="husband" />
          </action>

          <action id="call-father" label="üìû –ü–æ–∑–≤–æ–Ω–∏—Ç—å –ø–∞–ø–µ" icon="phone">
            <effects>
              <energy cost="5" />
              <time advance="30m" />
              <relationship target="father" change="+5" />
              <happiness change="+8" />
            </effects>
          </action>

          <action id="social" label="üì± –°–æ—Ü—Å–µ—Ç–∏" icon="users">
            <effects>
              <energy cost="5" />
              <time advance="15m" />
              <happiness change="+3" />
            </effects>
          </action>
        </actions>
      </object>

      <!-- –ó–ï–†–ö–ê–õ–û -->
      <object id="mirror" type="grooming" category="self-care">
        <position x="900" y="300" z-index="3" />
        <sprite size="96x96" />
        <reflection enabled="true" />
        <actions>
          <action id="groom" label="ü™û –ü—Ä–∏–≤–µ—Å—Ç–∏ —Å–µ–±—è –≤ –ø–æ—Ä—è–¥–æ–∫" icon="sparkles">
            <requirements>
              <energy min="10" />
            </requirements>
            <effects>
              <energy cost="10" />
              <time advance="15m" />
              <happiness change="+10" />
              <stat name="appearance" change="+20" duration="4h" />
            </effects>
            <animation character="interaction" duration="15m" />
          </action>
        </actions>
      </object>

      <!-- –®–ö–ê–§ -->
      <object id="wardrobe" type="storage" category="appearance">
        <position x="300" y="400" z-index="3" />
        <sprite size="128x128" />
        <actions>
          <action id="change-clothes" label="üëó –ü–µ—Ä–µ–æ–¥–µ—Ç—å—Å—è" icon="shirt">
            <requirements>
              <energy min="5" />
            </requirements>
            <effects>
              <energy cost="5" />
              <time advance="10m" />
              <happiness change="+5" />
            </effects>
            <opens-modal type="wardrobe-selection" />
          </action>
        </actions>
      </object>
    </interactive-objects>

    <!-- NPC –ü–ï–†–°–û–ù–ê–ñ–ò -->
    <npcs>
      <npc id="sam" ref="../../animation/characters/sam.xml">
        <type>–¶–≤–µ—Ä–≥–ø–∏–Ω—á–µ—Ä</type>
        <position dynamic="true" initial-x="400" initial-y="300" />
        <sprite size="48x48" />
        <behavior type="wander" bounds="room" speed="1">
          <favorite-spots>
            <spot near="bed" />
            <spot near="door" />
          </favorite-spots>
        </behavior>
        <interaction tap="true">
          <action id="pet" label="üêï –ü–æ–≥–ª–∞–¥–∏—Ç—å –°—ç–º–∞">
            <effects>
              <happiness change="+10" />
              <relationship target="sam" change="+5" />
            </effects>
            <animation dog="play" duration="5s" />
          </action>
        </interaction>
      </npc>

      <npc id="garfield" ref="../../animation/characters/garfield.xml">
        <type>–ö–æ—Ç</type>
        <visible condition="relationship[sam] > 50" />
        <position dynamic="true" />
        <behavior type="lazy">
          <favorite-spots>
            <spot at="bed" weight="50%" />
            <spot at="window" weight="30%" />
          </favorite-spots>
        </behavior>
      </npc>
    </npcs>
  </isometric-room>

  <!-- –í–ó–ê–ò–ú–û–î–ï–ô–°–¢–í–ò–Ø -->
  <interactions>
    <tap-object>
      <haptic intensity="light" />
      <visual-feedback>
        <scale from="1.0" to="1.05" duration="200ms" easing="ease-out" />
        <highlight type="glow" />
      </visual-feedback>
      <show-action-menu position="above-object" offset="0, -20px" animation="slideUp" />
    </tap-object>

    <action-menu>
      <background blur="12px" color="rgba(255,255,255,0.95)" />
      <border-radius>20px</border-radius>
      <padding>16px</padding>
      <max-width>280px</max-width>
      <shadow>0 8px 24px rgba(0,0,0,0.15)</shadow>
      
      <action-button height="48px" gap="8px">
        <icon size="24px" />
        <label size="1rem" weight="600" />
        <meta-info display="energy, time, rewards" size="0.75rem" color="#6B7280" />
        <disabled-state opacity="0.5" cursor="not-allowed" />
      </action-button>
    </action-menu>
  </interactions>

  <!-- –û–°–í–ï–©–ï–ù–ò–ï –ò –ê–¢–ú–û–°–§–ï–†–ê -->
  <atmosphere>
    <time-of-day-effects>
      <morning time="06:00-11:59">
        <lighting bright="true" warm="true" />
        <window-light color="#FFECD2" intensity="0.8" />
      </morning>
      
      <day time="12:00-17:59">
        <lighting bright="true" neutral="true" />
        <window-light color="#E0C3FC" intensity="1.0" />
      </day>
      
      <evening time="18:00-21:59">
        <lighting warm="true" dimmed="true" />
        <window-light color="#FFA17F" intensity="0.6" />
        <ceiling-light enabled="true" color="#FCD34D" />
      </evening>
      
      <night time="22:00-05:59">
        <lighting dark="true" />
        <window-light color="#2C3E50" intensity="0.2" />
        <ceiling-light enabled="true" color="#FCD34D" intensity="0.8" />
        <ambient-light color="#1F2937" />
      </night>
    </time-of-day-effects>
  </atmosphere>

  <!-- –¢–†–ï–ë–û–í–ê–ù–ò–Ø –ö –†–ï–ê–õ–ò–ó–ê–¶–ò–ò -->
  <implementation-requirements>
    <requirement priority="critical">–í—Å–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã –≤–∏–¥–Ω—ã –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –±–µ–∑ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏</requirement>
    <requirement priority="critical">–¢–∞—Ç—å—è–Ω–∞ –≤—Å–µ–≥–¥–∞ –≤ —Ü–µ–Ω—Ç—Ä–µ, –Ω–µ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞–µ—Ç—Å—è –æ–±—ä–µ–∫—Ç–∞–º–∏</requirement>
    <requirement priority="high">–ü–ª–∞–≤–Ω—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏ 200-300ms –¥–ª—è –≤—Å–µ—Ö –ø–µ—Ä–µ—Ö–æ–¥–æ–≤</requirement>
    <requirement priority="high">Haptic feedback –Ω–∞ –∫–∞–∂–¥—ã–π —Ç–∞–ø</requirement>
    <requirement priority="high">Action menu –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —Ç–∞–ø–µ –≤–Ω–µ –µ–≥–æ –æ–±–ª–∞—Å—Ç–∏</requirement>
    <requirement priority="medium">–û—Å–≤–µ—â–µ–Ω–∏–µ –º–µ–Ω—è–µ—Ç—Å—è –ø–ª–∞–≤–Ω–æ –ø—Ä–∏ —Å–º–µ–Ω–µ –≤—Ä–µ–º–µ–Ω–∏ —Å—É—Ç–æ–∫ (1000ms transition)</requirement>
    <requirement priority="medium">–°—ç–º –Ω–µ –¥–æ–ª–∂–µ–Ω –∑–∞—Å—Ç—Ä–µ–≤–∞—Ç—å –≤ –æ–±—ä–µ–∫—Ç–∞—Ö –ø—Ä–∏ wander</requirement>
    <requirement priority="low">Ambient –∞–Ω–∏–º–∞—Ü–∏–∏ –æ–±—ä–µ–∫—Ç–æ–≤ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Å game loop</requirement>
  </implementation-requirements>

</screen>
